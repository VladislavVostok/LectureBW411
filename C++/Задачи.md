
###  Задача: Многопоточная работа с файлом (Writer-Readers).

**Условие:**  
Необходимо реализовать программу на C++, в которой:

1. **Один поток (писатель, _writer_)** периодически записывает данные в файл.
    
2. **Несколько потоков (читатели, _readers_)** считывают данные из этого файла.
    
3. Обеспечить **потокобезопасность**, чтобы:
    - Читатели не видели частично записанных данных.
    - Не возникало **гонки данных** (_race condition_).
    - Писатель не блокировал читателей слишком долго.
        

#### **Требования:**

- Использовать `std::mutex` и `std::condition_variable` для синхронизации.
- Писатель должен записывать в файл случайные числа каждые 1-2 секунды.
- Читатели должны выводить прочитанные данные в консоль.
- Если файл пуст, читатели должны ждать, пока писатель не добавит данные.

Давайте подробно разберём эти три строки, которые отвечают за генерацию случайных чисел в C++:






### 1. `std::random_device rd;`
```cpp
std::random_device rd;
```
- **Что делает?**  
  Создаёт объект `random_device` с именем `rd`, который предоставляет доступ к аппаратному генератору случайных чисел (если он есть в системе).  
- **Особенности:**  
  - Использует **недетерминированные** источники энтропии (например, шум процессора, время нажатия клавиш и т.д.).  
  - Может быть медленным, поэтому обычно используется только для **инициализации** других генераторов.  
  - На некоторых системах (например, MinGW на Windows) может работать как обычный PRNG (псевдослучайный генератор), если аппаратный источник недоступен.  

---

### 2. `std::mt19937 gen(rd());`
```cpp
std::mt19937 gen(rd());
```
- **Что делает?**  
  Инициализирует генератор псевдослучайных чисел **Mersenne Twister** (`mt19937`) с "зерном" (seed) от `random_device`.  
- **Разберём по частям:**  
  - `std::mt19937` – это тип генератора, основанный на алгоритме **Mersenne Twister**.  
    - Период: \(2^{19937} - 1\) (очень длинный!).  
    - Быстрый и достаточно качественный для большинства задач.  
  - `gen(rd())` – передаёт случайное значение от `rd()` как **seed** (зерно) для инициализации генератора.  
    - `rd()` вызывает оператор `()` у `random_device`, возвращая случайное число.  

---

### 3. `std::uniform_int_distribution<> dist(1, 100);`
```cpp
std::uniform_int_distribution<> dist(1, 100);
```
- **Что делает?**  
  Создаёт объект `dist`, который преобразует выход генератора (`gen`) в **равномерно распределённые** целые числа в диапазоне `[1, 100]`.  
- **Подробности:**  
  - `std::uniform_int_distribution<>` – шаблонный класс для равномерного распределения.  
    - `<>` означает, что компилятор сам выведет тип (аналог `auto` для шаблонов).  
  - `dist(1, 100)` – задаёт диапазон:  
    - Минимум: 1  
    - Максимум: 100  

---

### Как это работает вместе?
```cpp
int num = dist(gen);  // Генерация числа
```
1. `gen` (Mersenne Twister) выдаёт псевдослучайное число.  
2. `dist` преобразует это число в равномерно распределённое в диапазоне `[1, 100]`.  

---

### Почему именно так?
1. **Почему не `rand()`?**  
   - `rand()` устарел, имеет плохое распределение и требует `srand()`.  
   - В C++11 появились более надежные инструменты (`<random>`).  

1. **`random_device` + `mt19937`**
   - `random_device` даёт случайное зерно (seed), чтобы `mt19937` каждый раз запускался с разного места.  
   - Если использовать фиксированный seed (например, `gen(123)`), последовательность будет одинаковой при каждом запуске программы.  

3. **Почему `uniform_int_distribution`?**  
   - Гарантирует **равномерное распределение** (каждое число в диапазоне имеет одинаковую вероятность).  
   - Без него пришлось бы использовать `rand() % 100 + 1`, что даёт смещённое распределение (не все числа равновероятны).  

---

### Пример полной генерации:
```cpp
#include <iostream>
#include <random>

int main() {
    std::random_device rd;
    std::mt19937 gen(rd());
    std::uniform_int_distribution<> dist(1, 100);

    for (int i = 0; i < 5; ++i) {
        std::cout << dist(gen) << " ";  // Например: 42 15 87 91 3
    }
}
```

1. **Фиксированный seed (для отладки):**
   ```cpp
   std::mt19937 gen(123);  // Всегда одинаковая последовательность
   ```

2. **Другие распределения:**
   - Равномерное вещественное:
     ```cpp
     std::uniform_real_distribution<double> dist(0.0, 1.0);
     ```
   - Нормальное распределение:
     ```cpp
     std::normal_distribution<double> dist(0.0, 1.0);  // Среднее = 0, stddev = 1
     ```