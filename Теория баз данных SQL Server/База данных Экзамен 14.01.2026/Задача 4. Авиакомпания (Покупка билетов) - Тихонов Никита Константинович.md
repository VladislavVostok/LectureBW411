**Тема:** Конкуррентная запись и резервирование мест.

**1. Сущности и связи (Таблицы):**

- **Flights** (Рейсы): `FlightID` (PK), `Destination`, `DepartureTime`, `SeatsAvailable` (свободные места).
- **Passengers** (Пассажиры): `PassengerID` (PK), `PassportNumber`, `Name`.
- **Tickets** (Билеты): `TicketID` (PK), `FlightID` (FK), `PassengerID` (FK), `Price`.

**2. Триггер:**

- Создать триггер **AFTER INSERT** на таблицу `Tickets`. При продаже билета триггер должен уменьшать количество `SeatsAvailable` в таблице `Flights`.

**3. Пользовательская функция:**

- Создать функцию `fn_GetFlightPassengers(@FlightID)`, возвращающую таблицу с именами всех пассажиров, купивших билеты на конкретный рейс.

**4. Хранимые процедуры:**

- `sp_CancelTicket`: Процедура для отмены бронирования билета. Принимает `TicketID`. Удаляет билет и должна вернуть место в общий пул рейса.

**5. Транзакция:**

- В процедуре `sp_CancelTicket` использовать транзакцию. Операция удаления билета (`DELETE` из `Tickets`) и увеличение количества мест (`UPDATE` `Flights`) должны быть выполнены в блоке транзакции для поддержания целостности данных.

### Замечания по решения:

   * Таблицы: Структуры таблиц Flights, Passengers, Tickets созданы корректно, с правильными ключами.
   * Триггер: Триггер ReduceSeatsOnSale написан верно. Он срабатывает после вставки в Tickets и уменьшает количество доступных мест в Flights.
   * Функция: Функция fn_GetFlightPassengers реализована правильно. Она принимает ID рейса и возвращает таблицу с именами пассажиров этого рейса.
   * Хранимая процедура: Процедура sp_CancelTicket для отмены билета сделана корректно, включая использование транзакции для обеспечения целостности данных (удаление билета и возврат места).

  **Вывод**: Полностью и правильно выполнил все пункты задания.

  **Оценка**: 12/12