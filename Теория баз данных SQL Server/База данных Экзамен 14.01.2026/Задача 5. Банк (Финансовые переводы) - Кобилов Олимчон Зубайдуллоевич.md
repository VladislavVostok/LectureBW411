**Тема:** Денежные операции и целостность данных.

**1. Сущности и связи (Таблицы):**

- **Clients** (Клиенты): `ClientID` (PK), `FullName`.
- **Accounts** (Счета): `AccountID` (PK), `ClientID` (FK), `Balance`.
- **Transactions** (История): `TransID` (PK), `FromAccountID` (FK), `ToAccountID` (FK), `Amount`, `TransDate`.

**2. Триггер:**

- Создать триггер **AFTER INSERT** на таблицу `Transactions`. Триггер должен обновлять баланс на счетах: списывать сумму с `FromAccountID` и начислять на `ToAccountID`.

**3. Пользовательская функция:**

- Создать скалярную функцию `fn_GetTotalBalance(@ClientID)`, которая суммирует остатки по всем счетам (`Balance`) указанного клиента.

**4. Хранимые процедуры:**

- `sp_MakeTransfer`: Процедура перевода денег между счетами. Принимает `SenderAccountID`, `ReceiverAccountID`, `Amount`. Перед вызовом триггера (или вместо него, если логика перенесена в процедуру) должна проверять достаточно ли средств.

**5. Транзакция:**

- В процедуре `sp_MakeTransfer` реализовать транзакцию. Необходимо вставить запись в `Transactions` и обновить балансы в `Accounts`. Если баланс отправителя станет отрицательным, транзакция должна быть откачена (`ROLLBACK`).